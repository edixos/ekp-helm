prometheus:
  enabled: false
  rules:
    enabled: false
    labels:
      prometheus: prometheus-operator-prometheus
  grafanaDashboard:
    enabled: false
    label:
      grafana_dashboard: "1"

oathkeeper:
  accessRules: >-
    [
      {
        "id": "allow-all-for-testing",
        "description": "Dummy rule to make readiness pass",
        "match": {
          "methods": ["GET", "POST", "PUT", "DELETE", "PATCH"],
          "url": "<.*>"
        },
        "authenticators": [
          { "handler": "noop" }
        ],
        "authorizer": {
          "handler": "allow"
        },
        "mutators": [
          { "handler": "noop" }
        ]
      }
    ]
  config:
    serve:
      proxy:
        port: 4455
        host: "0.0.0.0"
        timeout:
          read: 5s
          write: 5s
          idle: 5s
        cors:
          enabled: true
          allowed_origins:
            - "http://localhost:5173"
          allowed_methods:
            - GET
            - HEAD
            - POST
            - PUT
            - DELETE
            - PATCH
          allowed_headers:
            - Content-Type
            - Authorization
          allow_credentials: false
          max_age: 3600

      api:
        port: 4456
        host: "0.0.0.0"

    authenticators:
      noop:
        enabled: true
      oauth2_introspection:
        enabled: true
        config:
          introspection_url: "http://hydra-admin.hydra.svc.cluster.local:4445/admin/oauth2/introspect"
          scope_strategy: "hierarchic"
          cache:
            enabled: true
            ttl: 60s
          required_scope: []

      anonymous:
        enabled: true
        config:
          subject: "anonymous"

    authorizers:
      allow:
        enabled: true

      deny:
        enabled: true

      remote_json:
        enabled: true
        config:
          remote: "http://keto-read.keto.svc.cluster.local/check"
          payload: '{"namespace": "default", "object": "default", "relation": "viewer", "subject_id": "{{ .Subject }}"}'
          forward_response_headers_to_upstream: []
          retry:
            give_up_after: 100ms
            max_delay: 10ms

    mutators:
      header:
        enabled: true
        config:
          headers:
            X-User: "{{ .Subject }}"
            X-User-ID: "{{ .Extra.id }}"
            X-User-Email: "{{ .Extra.email }}"
      noop:
        enabled: true

    log:
      level: "info"
      format: "json"

maester:
  enabled: false
