apiVersion: container.cnrm.cloud.google.com/v1beta1
kind: ContainerCluster
metadata:
  annotations:
{{- if .Values.global.abandon }}
    cnrm.cloud.google.com/deletion-policy: abandon
{{- end }}
    cnrm.cloud.google.com/remove-default-node-pool: {{ .Values.removeDefaultNodePool | quote  }}
    cnrm.cloud.google.com/project-id: {{ .Values.global.gcpProjectId | quote }}
{{- if .Values.global.skipUnspecifiedFields }}
    cnrm.cloud.google.com/state-into-spec: absent
{{- end }}
  labels:
{{- include "gcp-gke-cluster.labels" . | nindent 4 }}
  name: {{ include "gcp-gke-cluster.fullname" . }}
  namespace: {{ include "gcp-gke-cluster.namespace" . }}
spec:
  description: {{ .Values.description }}
  location: {{ .Values.location }}
  initialNodeCount: {{ .Values.initialNodeCount }}
  {{- if .Values.networkRef }}
  networkRef:
    {{- if .Values.networkRef.external }}
    external: {{ .Values.networkRef.external }}
    {{- end }}
    {{- if .Values.networkRef.name }}
    name: {{ .Values.networkRef.name }}
    {{- end }}
    {{- if .Values.networkRef.namespace }}
    namespace: {{ .Values.networkRef.namespace }}
    {{- end }}
  {{- end }}
  {{- if .Values.subnetworkRef }}
  subnetworkRef:
    {{- if .Values.subnetworkRef.external }}
    external: {{ .Values.subnetworkRef.external }}
    {{- end }}
    {{- if .Values.subnetworkRef.name }}
    name: {{ .Values.subnetworkRef.name }}
    {{- end }}
    {{- if .Values.subnetworkRef.namespace }}
    namespace: {{ .Values.subnetworkRef.namespace }}
    {{- end }}
  {{- end }}
  networkingMode: {{ .Values.networkingMode }}
  {{- if .Values.clusterIpv4Cidr }}
  clusterIpv4Cidr: {{ .Values.clusterIpv4Cidr }}
  {{- end }}
  {{- if .Values.defaultMaxPodsPerNode }}
  defaultMaxPodsPerNode: {{ .Values.defaultMaxPodsPerNode }}
  {{- end }}
  enableKubernetesAlpha: {{ .Values.enableKubernetesAlpha }}
  enableLegacyAbac: {{ .Values.enableLegacyAbac }}
  enableShieldedNodes: {{ .Values.enableShieldedNodes }}
  enableTpu: {{ .Values.enableTpu }}
  enableIntranodeVisibility: {{ .Values.enableIntranodeVisibility }}
  enableL4IlbSubsetting: {{ .Values.enableL4IlbSubsetting }}
  enableFqdnNetworkPolicy: {{ .Values.enableFqdnNetworkPolicy }}
  enableBinaryAuthorization: {{ .Values.enableBinaryAuthorization }}
  enableAutopilot: {{ .Values.enableAutopilot }}
  enableMultiNetworking: {{ .Values.enableMultiNetworking }}
  {{- if .Values.enableK8sBetaApis }}
  enableK8sBetaApis:
    {{- if .Values.enableK8sBetaApis.enabledApis }}
    enabledApis: {{ toYaml .Values.enableK8sBetaApis.enabledApis | nindent 6 }}
    {{- end }}
  {{- end }}
  {{- if .Values.addonsConfig }}
  addonsConfig:
    {{- if .Values.addonsConfig.cloudrunConfig }}
    cloudrunConfig:
      disabled: {{ .Values.addonsConfig.cloudrunConfig.disabled }}
      {{- if .Values.addonsConfig.cloudrunConfig.loadBalancerType }}
      loadBalancerType: {{ .Values.addonsConfig.cloudrunConfig.loadBalancerType }}
      {{- end }}
    {{- end }}
    {{- if .Values.addonsConfig.configConnectorConfig }}
    configConnectorConfig:
      enabled: {{ .Values.addonsConfig.configConnectorConfig.enabled }}
    {{- end }}
    {{- if .Values.addonsConfig.dnsCacheConfig }}
    dnsCacheConfig:
      enabled: {{ .Values.addonsConfig.dnsCacheConfig.enabled }}
    {{- end }}
    {{- if .Values.addonsConfig.gcePersistentDiskCsiDriverConfig }}
    gcePersistentDiskCsiDriverConfig:
      enabled: {{ .Values.addonsConfig.gcePersistentDiskCsiDriverConfig.enabled }}
    {{- end }}
    {{- if .Values.addonsConfig.gcpFilestoreCsiDriverConfig }}
    gcpFilestoreCsiDriverConfig:
      enabled: {{ .Values.addonsConfig.gcpFilestoreCsiDriverConfig.enabled }}
    {{- end }}
    {{- if .Values.addonsConfig.gcsFuseCsiDriverConfig }}
    gcsFuseCsiDriverConfig:
      enabled: {{ .Values.addonsConfig.gcsFuseCsiDriverConfig.enabled }}
    {{- end }}
    {{- if .Values.addonsConfig.gkeBackupAgentConfig }}
    gkeBackupAgentConfig:
      enabled: {{ .Values.addonsConfig.gkeBackupAgentConfig.enabled }}
    {{- end }}
    {{- if .Values.addonsConfig.horizontalPodAutoscaling }}
    horizontalPodAutoscaling:
      disabled: {{ .Values.addonsConfig.horizontalPodAutoscaling.disabled }}
    {{- end }}
    {{- if .Values.addonsConfig.httpLoadBalancing }}
    httpLoadBalancing:
      disabled: {{ .Values.addonsConfig.httpLoadBalancing.disabled }}
    {{- end }}
    {{- if .Values.addonsConfig.istioConfig }}
    istioConfig:
      auth: {{ .Values.addonsConfig.istioConfig.auth }}
      disabled: {{ .Values.addonsConfig.istioConfig.disabled }}
    {{- end }}
    {{- if .Values.addonsConfig.kalmConfig }}
    kalmConfig:
      enabled: {{ .Values.addonsConfig.kalmConfig.enabled }}
    {{- end }}
    {{- if .Values.addonsConfig.networkPolicyConfig }}
    networkPolicyConfig:
      disabled: {{ .Values.addonsConfig.networkPolicyConfig.disabled }}
    {{- end }}
  {{- end }}
  {{- if .Values.authenticatorGroupsConfig }}
  authenticatorGroupsConfig:
    {{- if .Values.authenticatorGroupsConfig.securityGroup }}
    securityGroup: {{ .Values.authenticatorGroupsConfig.securityGroup }}
    {{- end }}
  {{- end }}
  {{- if .Values.binaryAuthorization }}
  binaryAuthorization:
    enabled: {{ .Values.binaryAuthorization.enabled }}
    {{- if .Values.binaryAuthorization.evaluationMode }}
    evaluationMode: {{ .Values.binaryAuthorization.evaluationMode }}
    {{- end }}
  {{- end }}
  {{- if .Values.clusterAutoscaling }}
  clusterAutoscaling:
    {{- if .Values.clusterAutoscaling.autoProvisioningDefaults }}
    autoProvisioningDefaults:
      {{- if .Values.clusterAutoscaling.autoProvisioningDefaults.bootDiskKMSKeyRef }}
      bootDiskKMSKeyRef:
        {{- if .Values.clusterAutoscaling.autoProvisioningDefaults.bootDiskKMSKeyRef.external }}
        external: {{ .Values.clusterAutoscaling.autoProvisioningDefaults.bootDiskKMSKeyRef.external }}
        {{- end }}
        {{- if .Values.clusterAutoscaling.autoProvisioningDefaults.bootDiskKMSKeyRef.name }}
        name: {{ .Values.clusterAutoscaling.autoProvisioningDefaults.bootDiskKMSKeyRef.name }}
        {{- end }}
        {{- if .Values.clusterAutoscaling.autoProvisioningDefaults.bootDiskKMSKeyRef.namespace }}
        namespace: {{ .Values.clusterAutoscaling.autoProvisioningDefaults.bootDiskKMSKeyRef.namespace }}
        {{- end }}
      {{- end }}
      diskSize: {{ .Values.clusterAutoscaling.autoProvisioningDefaults.diskSize }}
      {{- if .Values.clusterAutoscaling.autoProvisioningDefaults.imageType }}
      imageType: {{ .Values.clusterAutoscaling.autoProvisioningDefaults.imageType }}
      {{- end }}
      {{- if .Values.clusterAutoscaling.autoProvisioningDefaults.management }}
      management:
        autoRepair: {{ .Values.clusterAutoscaling.autoProvisioningDefaults.management.autoRepair }}
        autoUpgrade: {{ .Values.clusterAutoscaling.autoProvisioningDefaults.management.autoUpgrade }}
        {{- if .Values.clusterAutoscaling.autoProvisioningDefaults.management.upgradeOptions }}
        upgradeOptions:
          {{- if .Values.clusterAutoscaling.autoProvisioningDefaults.management.upgradeOptions.autoUpgradeStartTime }}
          autoUpgradeStartTime: {{ .Values.clusterAutoscaling.autoProvisioningDefaults.management.upgradeOptions.autoUpgradeStartTime }}
          {{- end }}
          {{- if .Values.clusterAutoscaling.autoProvisioningDefaults.management.upgradeOptions.description }}
          description: {{ .Values.clusterAutoscaling.autoProvisioningDefaults.management.upgradeOptions.description }}
          {{- end }}
        {{- end }}
      {{- end }}
      {{- if .Values.clusterAutoscaling.autoProvisioningDefaults.minCpuPlatform }}
      minCpuPlatform: {{ .Values.clusterAutoscaling.autoProvisioningDefaults.minCpuPlatform }}
      {{- end }}
      {{- if .Values.clusterAutoscaling.autoProvisioningDefaults.oauthScopes }}
      oauthScopes: {{ toYaml .Values.clusterAutoscaling.autoProvisioningDefaults.oauthScopes | nindent 8 }}
      {{- end }}
      {{- if .Values.clusterAutoscaling.autoProvisioningDefaults.serviceAccountRef }}
      serviceAccountRef:
        {{- if .Values.clusterAutoscaling.autoProvisioningDefaults.serviceAccountRef.external }}
        external: {{ .Values.clusterAutoscaling.autoProvisioningDefaults.serviceAccountRef.external }}
        {{- end }}
        {{- if .Values.clusterAutoscaling.autoProvisioningDefaults.serviceAccountRef.name }}
        name: {{ .Values.clusterAutoscaling.autoProvisioningDefaults.serviceAccountRef.name }}
        {{- end }}
        {{- if .Values.clusterAutoscaling.autoProvisioningDefaults.serviceAccountRef.namespace }}
        namespace: {{ .Values.clusterAutoscaling.autoProvisioningDefaults.serviceAccountRef.namespace }}
        {{- end }}
      {{- end }}
      {{- if .Values.clusterAutoscaling.autoProvisioningDefaults.shieldedInstanceConfig }}
      shieldedInstanceConfig:
        enableIntegrityMonitoring: {{ .Values.clusterAutoscaling.autoProvisioningDefaults.shieldedInstanceConfig.enableIntegrityMonitoring }}
        enableSecureBoot: {{ .Values.clusterAutoscaling.autoProvisioningDefaults.shieldedInstanceConfig.enableSecureBoot }}
      {{- end }}
      {{- if .Values.clusterAutoscaling.autoProvisioningDefaults.upgradeSettings }}
      upgradeSettings:
        {{- if .Values.clusterAutoscaling.autoProvisioningDefaults.upgradeSettings.blueGreenSettings }}
        blueGreenSettings:
          {{- if .Values.clusterAutoscaling.autoProvisioningDefaults.upgradeSettings.blueGreenSettings.nodePoolSoakDuration }}
          nodePoolSoakDuration: {{ .Values.clusterAutoscaling.autoProvisioningDefaults.upgradeSettings.blueGreenSettings.nodePoolSoakDuration }}
          {{- end }}
          {{- if .Values.clusterAutoscaling.autoProvisioningDefaults.upgradeSettings.blueGreenSettings.standardRolloutPolicy }}
          standardRolloutPolicy:
            {{- if .Values.clusterAutoscaling.autoProvisioningDefaults.upgradeSettings.blueGreenSettings.standardRolloutPolicy.batchNodeCount }}
            batchNodeCount: {{ .Values.clusterAutoscaling.autoProvisioningDefaults.upgradeSettings.blueGreenSettings.standardRolloutPolicy.batchNodeCount }}
            {{- end }}
            {{- if .Values.clusterAutoscaling.autoProvisioningDefaults.upgradeSettings.blueGreenSettings.standardRolloutPolicy.batchPercentage }}
            batchPercentage: {{ .Values.clusterAutoscaling.autoProvisioningDefaults.upgradeSettings.blueGreenSettings.standardRolloutPolicy.batchPercentage }}
            {{- end }}
            {{- if .Values.clusterAutoscaling.autoProvisioningDefaults.upgradeSettings.blueGreenSettings.standardRolloutPolicy.batchSoakDuration }}
            batchSoakDuration: {{ .Values.clusterAutoscaling.autoProvisioningDefaults.upgradeSettings.blueGreenSettings.standardRolloutPolicy.batchSoakDuration }}
            {{- end }}
          {{- end }}
        {{- end }}
        {{- if .Values.clusterAutoscaling.autoProvisioningDefaults.upgradeSettings.maxSurge }}
        maxSurge: {{ .Values.clusterAutoscaling.autoProvisioningDefaults.upgradeSettings.maxSurge }}
        {{- end }}
        {{- if .Values.clusterAutoscaling.autoProvisioningDefaults.upgradeSettings.maxUnavailable }}
        maxUnavailable: {{ .Values.clusterAutoscaling.autoProvisioningDefaults.upgradeSettings.maxUnavailable }}
        {{- end }}
        {{- if .Values.clusterAutoscaling.autoProvisioningDefaults.upgradeSettings.strategy }}
        strategy: {{ .Values.clusterAutoscaling.autoProvisioningDefaults.upgradeSettings.strategy }}
        {{- end }}
      {{- end }}
    {{- end }}
    autoscalingProfile: {{ .Values.clusterAutoscaling.autoscalingProfile }}
    enabled: {{ .Values.clusterAutoscaling.enabled }}
    {{- if .Values.clusterAutoscaling.resourceLimits }}
    resourceLimits: {{ toYaml .Values.clusterAutoscaling.resourceLimits | nindent 6 }}
    {{- end }}
  {{- end }}
  {{- if .Values.clusterTelemetry }}
  clusterTelemetry:
    {{- if .Values.clusterTelemetry.type }}
    type: {{ .Values.clusterTelemetry.type }}
    {{- end }}
  {{- end }}
  {{- if .Values.confidentialNodes }}
  confidentialNodes:
    enabled: {{ .Values.confidentialNodes.enabled }}
  {{- end }}
  {{- if .Values.costManagementConfig }}
  costManagementConfig:
    enabled: {{ .Values.costManagementConfig.enabled }}
  {{- end }}
  {{- if .Values.databaseEncryption }}
  databaseEncryption:
    {{- if .Values.databaseEncryption.keyName }}
    keyName: {{ .Values.databaseEncryption.keyName }}
    {{- end }}
    {{- if .Values.databaseEncryption.state }}
    state: {{ .Values.databaseEncryption.state }}
    {{- end }}
  {{- end }}
  {{- if .Values.datapathProvider }}
  datapathProvider: {{ .Values.datapathProvider }}
  {{- end }}
  {{- if .Values.defaultSnatStatus }}
  defaultSnatStatus:
    disabled: {{ .Values.defaultSnatStatus.disabled }}
  {{- end }}
  {{- if .Values.dnsConfig }}
  dnsConfig:
    {{- if .Values.dnsConfig.clusterDns }}
    clusterDns: {{ .Values.dnsConfig.clusterDns }}
    {{- end }}
    {{- if .Values.dnsConfig.clusterDnsDomain }}
    clusterDnsDomain: {{ .Values.dnsConfig.clusterDnsDomain }}
    {{- end }}
    {{- if .Values.dnsConfig.clusterDnsScope }}
    clusterDnsScope: {{ .Values.dnsConfig.clusterDnsScope }}
    {{- end }}
  {{- end }}
  {{- if .Values.gatewayApiConfig }}
  gatewayApiConfig:
    {{- if .Values.gatewayApiConfig.channel }}
    channel: {{ .Values.gatewayApiConfig.channel }}
    {{- end }}
  {{- end }}
  {{- if .Values.identityServiceConfig }}
  identityServiceConfig:
    enabled: {{ .Values.identityServiceConfig.enabled }}
  {{- end }}
  {{- if .Values.ipAllocationPolicy }}
  ipAllocationPolicy:
    {{- if .Values.ipAllocationPolicy.additionalPodRangesConfig }}
    additionalPodRangesConfig:
      {{- if .Values.ipAllocationPolicy.additionalPodRangesConfig.podRangeNames }}
      podRangeNames: {{ toYaml .Values.ipAllocationPolicy.additionalPodRangesConfig.podRangeNames | nindent 8 }}
      {{- end }}
    {{- end }}
    {{- if .Values.ipAllocationPolicy.clusterIpv4CidrBlock }}
    clusterIpv4CidrBlock: {{ .Values.ipAllocationPolicy.clusterIpv4CidrBlock }}
    {{- end }}
    {{- if .Values.ipAllocationPolicy.clusterSecondaryRangeName }}
    clusterSecondaryRangeName: {{ .Values.ipAllocationPolicy.clusterSecondaryRangeName }}
    {{- end }}
    {{- if .Values.ipAllocationPolicy.podCidrOverprovisionConfig }}
    podCidrOverprovisionConfig:
      disabled: {{ .Values.ipAllocationPolicy.podCidrOverprovisionConfig.disabled }}
    {{- end }}
    {{- if .Values.ipAllocationPolicy.servicesIpv4CidrBlock }}
    servicesIpv4CidrBlock: {{ .Values.ipAllocationPolicy.servicesIpv4CidrBlock }}
    {{- end }}
    {{- if .Values.ipAllocationPolicy.servicesSecondaryRangeName }}
    servicesSecondaryRangeName: {{ .Values.ipAllocationPolicy.servicesSecondaryRangeName }}
    {{- end }}
    {{- if .Values.ipAllocationPolicy.stackType }}
    stackType: {{ .Values.ipAllocationPolicy.stackType }}
    {{- end }}
  {{- end }}
  {{- if .Values.loggingConfig }}
  loggingConfig:
    {{- if .Values.loggingConfig.enableComponents }}
    enableComponents: {{ toYaml .Values.loggingConfig.enableComponents | nindent 6 }}
    {{- end }}
  {{- end }}
  loggingService: {{ .Values.loggingService }}
  {{- if .Values.maintenancePolicy }}
  maintenancePolicy:
    {{- if .Values.maintenancePolicy.dailyMaintenanceWindow }}
    dailyMaintenanceWindow:
      {{- if .Values.maintenancePolicy.dailyMaintenanceWindow.duration }}
      duration: {{ .Values.maintenancePolicy.dailyMaintenanceWindow.duration }}
      {{- end }}
      {{- if .Values.maintenancePolicy.dailyMaintenanceWindow.startTime }}
      startTime: {{ .Values.maintenancePolicy.dailyMaintenanceWindow.startTime }}
      {{- end }}
    {{- end }}
    {{- if .Values.maintenancePolicy.maintenanceExclusion }}
    maintenanceExclusion: {{ toYaml .Values.maintenancePolicy.maintenanceExclusion | nindent 6 }}
    {{- end }}
    {{- if .Values.maintenancePolicy.recurringWindow }}
    recurringWindow:
      {{- if .Values.maintenancePolicy.recurringWindow.endTime }}
      endTime: {{ .Values.maintenancePolicy.recurringWindow.endTime }}
      {{- end }}
      {{- if .Values.maintenancePolicy.recurringWindow.recurrence }}
      recurrence: {{ .Values.maintenancePolicy.recurringWindow.recurrence }}
      {{- end }}
      {{- if .Values.maintenancePolicy.recurringWindow.startTime }}
      startTime: {{ .Values.maintenancePolicy.recurringWindow.startTime }}
      {{- end }}
    {{- end }}
  {{- end }}
  {{- if .Values.masterAuth }}
  masterAuth:
    {{- if .Values.masterAuth.clientCertificate }}
    clientCertificate: {{ .Values.masterAuth.clientCertificate }}
    {{- end }}
    {{- if .Values.masterAuth.clientCertificateConfig }}
    clientCertificateConfig:
      issueClientCertificate: {{ .Values.masterAuth.clientCertificateConfig.issueClientCertificate }}
    {{- end }}
    {{- if .Values.masterAuth.clientKey }}
    clientKey: {{ .Values.masterAuth.clientKey }}
    {{- end }}
    {{- if .Values.masterAuth.clusterCaCertificate }}
    clusterCaCertificate: {{ .Values.masterAuth.clusterCaCertificate }}
    {{- end }}
    {{- if .Values.masterAuth.password }}
    password:
      {{- if .Values.masterAuth.password.value }}
      value: {{ .Values.masterAuth.password.value }}
      {{- end }}
      {{- if .Values.masterAuth.password.valueFrom }}
      valueFrom:
        {{- if .Values.masterAuth.password.valueFrom.secretKeyRef }}
        secretKeyRef:
          {{- if .Values.masterAuth.password.valueFrom.secretKeyRef.key }}
          key: {{ .Values.masterAuth.password.valueFrom.secretKeyRef.key }}
          {{- end }}
          {{- if .Values.masterAuth.password.valueFrom.secretKeyRef.name }}
          name: {{ .Values.masterAuth.password.valueFrom.secretKeyRef.name }}
          {{- end }}
        {{- end }}
      {{- end }}
    {{- end }}
    {{- if .Values.masterAuth.username }}
    username: {{ .Values.masterAuth.username }}
    {{- end }}
  {{- end }}
  {{- if .Values.masterAuthorizedNetworksConfig }}
  masterAuthorizedNetworksConfig:
    {{- if .Values.masterAuthorizedNetworksConfig.cidrBlocks }}
    cidrBlocks: {{ toYaml .Values.masterAuthorizedNetworksConfig.cidrBlocks | nindent 6 }}
    {{- end }}
    gcpPublicCidrsAccessEnabled: {{ .Values.masterAuthorizedNetworksConfig.gcpPublicCidrsAccessEnabled }}
  {{- end }}
  {{- if .Values.meshCertificates }}
  meshCertificates:
    enableCertificates: {{ .Values.meshCertificates.enableCertificates }}
  {{- end }}
  {{- if .Values.minMasterVersion }}
  minMasterVersion: {{ .Values.minMasterVersion }}
  {{- end }}
  {{- if .Values.monitoringConfig }}
  monitoringConfig:
    {{- if .Values.monitoringConfig.advancedDatapathObservabilityConfig }}
    advancedDatapathObservabilityConfig: {{ toYaml .Values.monitoringConfig.advancedDatapathObservabilityConfig | nindent 6 }}
    {{- end }}
    {{- if .Values.monitoringConfig.enableComponents }}
    enableComponents: {{ toYaml .Values.monitoringConfig.enableComponents | nindent 6 }}
    {{- end }}
    {{- if .Values.monitoringConfig.managedPrometheus }}
    managedPrometheus:
      enabled: {{ .Values.monitoringConfig.managedPrometheus.enabled }}
    {{- end }}
  {{- end }}
  monitoringService: {{ .Values.monitoringService }}
  {{- if .Values.networkPolicy }}
  networkPolicy:
    enabled: {{ .Values.networkPolicy.enabled }}
    {{- if .Values.networkPolicy.provider }}
    provider: {{ .Values.networkPolicy.provider }}
    {{- end }}
  {{- end }}
  {{- if .Values.nodeConfig }}
  nodeConfig:
    {{- if .Values.nodeConfig.advancedMachineFeatures }}
    advancedMachineFeatures:
      threadsPerCore: {{ .Values.nodeConfig.advancedMachineFeatures.threadsPerCore }}
    {{- end }}
    {{- if .Values.nodeConfig.bootDiskKMSCryptoKeyRef }}
    bootDiskKMSCryptoKeyRef:
      {{- if .Values.nodeConfig.bootDiskKMSCryptoKeyRef.external }}
      external: {{ .Values.nodeConfig.bootDiskKMSCryptoKeyRef.external }}
      {{- end }}
      {{- if .Values.nodeConfig.bootDiskKMSCryptoKeyRef.name }}
      name: {{ .Values.nodeConfig.bootDiskKMSCryptoKeyRef.name }}
      {{- end }}
      {{- if .Values.nodeConfig.bootDiskKMSCryptoKeyRef.namespace }}
      namespace: {{ .Values.nodeConfig.bootDiskKMSCryptoKeyRef.namespace }}
      {{- end }}
    {{- end }}
    {{- if .Values.nodeConfig.confidentialNodes }}
    confidentialNodes:
      enabled: {{ .Values.nodeConfig.confidentialNodes.enabled }}
    {{- end }}
    diskSizeGb: {{ .Values.nodeConfig.diskSizeGb }}
    {{- if .Values.nodeConfig.diskType }}
    diskType: {{ .Values.nodeConfig.diskType }}
    {{- end }}
    {{- if .Values.nodeConfig.ephemeralStorageConfig }}
    ephemeralStorageConfig:
      localSsdCount: {{ .Values.nodeConfig.ephemeralStorageConfig.localSsdCount }}
    {{- end }}
    {{- if .Values.nodeConfig.ephemeralStorageLocalSsdConfig }}
    ephemeralStorageLocalSsdConfig:
      localSsdCount: {{ .Values.nodeConfig.ephemeralStorageLocalSsdConfig.localSsdCount }}
    {{- end }}
    {{- if .Values.nodeConfig.fastSocket }}
    fastSocket:
      enabled: {{ .Values.nodeConfig.fastSocket.enabled }}
    {{- end }}
    {{- if .Values.nodeConfig.gcfsConfig }}
    gcfsConfig:
      enabled: {{ .Values.nodeConfig.gcfsConfig.enabled }}
    {{- end }}
    {{- if .Values.nodeConfig.guestAccelerator }}
    guestAccelerator: {{ toYaml .Values.nodeConfig.guestAccelerator | nindent 6 }}
    {{- end }}
    {{- if .Values.nodeConfig.gvnic }}
    gvnic:
      enabled: {{ .Values.nodeConfig.gvnic.enabled }}
    {{- end }}
    {{- if .Values.nodeConfig.hostMaintenancePolicy }}
    hostMaintenancePolicy:
      maintenanceInterval: {{ .Values.nodeConfig.hostMaintenancePolicy.maintenanceInterval }}
    {{- end }}
    {{- if .Values.nodeConfig.imageType }}
    imageType: {{ .Values.nodeConfig.imageType }}
    {{- end }}
    {{- if .Values.nodeConfig.kubeletConfig }}
    kubeletConfig:
      cpuCfsQuota: {{ .Values.nodeConfig.kubeletConfig.cpuCfsQuota }}
      {{- if .Values.nodeConfig.kubeletConfig.cpuCfsQuotaPeriod }}
      cpuCfsQuotaPeriod: {{ .Values.nodeConfig.kubeletConfig.cpuCfsQuotaPeriod }}
      {{- end }}
      {{- if .Values.nodeConfig.kubeletConfig.cpuManagerPolicy }}
      cpuManagerPolicy: {{ .Values.nodeConfig.kubeletConfig.cpuManagerPolicy }}
      {{- end }}
      {{- if .Values.nodeConfig.kubeletConfig.podPidsLimit }}
      podPidsLimit: {{ .Values.nodeConfig.kubeletConfig.podPidsLimit }}
      {{- end }}
    {{- end }}
    {{- if .Values.nodeConfig.labels }}
    labels: {{ toYaml .Values.nodeConfig.labels | nindent 6 }}
    {{- end }}
    {{- if .Values.nodeConfig.linuxNodeConfig }}
    linuxNodeConfig:
      {{- if .Values.nodeConfig.linuxNodeConfig.cgroupMode }}
      cgroupMode: {{ .Values.nodeConfig.linuxNodeConfig.cgroupMode }}
      {{- end }}
      {{- if .Values.nodeConfig.linuxNodeConfig.sysctls }}
      sysctls: {{ toYaml .Values.nodeConfig.linuxNodeConfig.sysctls | nindent 8 }}
      {{- end }}
    {{- end }}
    {{- if .Values.nodeConfig.localNvmeSsdBlockConfig }}
    localNvmeSsdBlockConfig:
      localSsdCount: {{ .Values.nodeConfig.localNvmeSsdBlockConfig.localSsdCount }}
    {{- end }}
    {{- if .Values.nodeConfig.localSsdCount }}
    localSsdCount: {{ .Values.nodeConfig.localSsdCount }}
    {{- end }}
    {{- if .Values.nodeConfig.loggingVariant }}
    loggingVariant: {{ .Values.nodeConfig.loggingVariant }}
    {{- end }}
    {{- if .Values.nodeConfig.machineType }}
    machineType: {{ .Values.nodeConfig.machineType }}
    {{- end }}
    {{- if .Values.nodeConfig.metadata }}
    metadata: {{ toYaml .Values.nodeConfig.metadata | nindent 6 }}
    {{- end }}
    {{- if .Values.nodeConfig.minCpuPlatform }}
    minCpuPlatform: {{ .Values.nodeConfig.minCpuPlatform }}
    {{- end }}
    {{- if .Values.nodeConfig.nodeGroupRef }}
    nodeGroupRef:
      {{- if .Values.nodeConfig.nodeGroupRef.external }}
      external: {{ .Values.nodeConfig.nodeGroupRef.external }}
      {{- end }}
      {{- if .Values.nodeConfig.nodeGroupRef.name }}
      name: {{ .Values.nodeConfig.nodeGroupRef.name }}
      {{- end }}
      {{- if .Values.nodeConfig.nodeGroupRef.namespace }}
      namespace: {{ .Values.nodeConfig.nodeGroupRef.namespace }}
      {{- end }}
    {{- end }}
    {{- if .Values.nodeConfig.oauthScopes }}
    oauthScopes: {{ toYaml .Values.nodeConfig.oauthScopes | nindent 6 }}
    {{- end }}
    {{- if .Values.nodeConfig.preemptible }}
    preemptible: {{ .Values.nodeConfig.preemptible }}
    {{- end }}
    {{- if .Values.nodeConfig.reservationAffinity }}
    reservationAffinity:
      {{- if .Values.nodeConfig.reservationAffinity.consumeReservationType }}
      consumeReservationType: {{ .Values.nodeConfig.reservationAffinity.consumeReservationType }}
      {{- end }}
      {{- if .Values.nodeConfig.reservationAffinity.key }}
      key: {{ .Values.nodeConfig.reservationAffinity.key }}
      {{- end }}
      {{- if .Values.nodeConfig.reservationAffinity.values }}
      values: {{ toYaml .Values.nodeConfig.reservationAffinity.values | nindent 8 }}
      {{- end }}
    {{- end }}
    {{- if .Values.nodeConfig.resourceLabels }}
    resourceLabels: {{ toYaml .Values.nodeConfig.resourceLabels | nindent 6 }}
    {{- end }}
    {{- if .Values.nodeConfig.sandboxConfig }}
    sandboxConfig:
      sandboxType: {{ .Values.nodeConfig.sandboxConfig.sandboxType }}
    {{- end }}
    {{- if .Values.nodeConfig.serviceAccountRef }}
    serviceAccountRef:
      {{- if .Values.nodeConfig.serviceAccountRef.external }}
      external: {{ .Values.nodeConfig.serviceAccountRef.external }}
      {{- end }}
      {{- if .Values.nodeConfig.serviceAccountRef.name }}
      name: {{ .Values.nodeConfig.serviceAccountRef.name }}
      {{- end }}
      {{- if .Values.nodeConfig.serviceAccountRef.namespace }}
      namespace: {{ .Values.nodeConfig.serviceAccountRef.namespace }}
      {{- end }}
    {{- end }}
    {{- if .Values.nodeConfig.shieldedInstanceConfig }}
    shieldedInstanceConfig:
      enableIntegrityMonitoring: {{ .Values.nodeConfig.shieldedInstanceConfig.enableIntegrityMonitoring }}
      enableSecureBoot: {{ .Values.nodeConfig.shieldedInstanceConfig.enableSecureBoot }}
    {{- end }}
    {{- if .Values.nodeConfig.soleTenantConfig }}
    soleTenantConfig:
      {{- if .Values.nodeConfig.soleTenantConfig.nodeAffinity }}
      nodeAffinity: {{ toYaml .Values.nodeConfig.soleTenantConfig.nodeAffinity | nindent 6 }}
      {{- end }}
    {{- end }}
    {{- if .Values.nodeConfig.spot }}
    spot: {{ .Values.nodeConfig.spot }}
    {{- end }}
    {{- if .Values.nodeConfig.tags }}
    tags: {{ toYaml .Values.nodeConfig.tags | nindent 6 }}
    {{- end }}
    {{- if .Values.nodeConfig.taint }}
    taint: {{ toYaml .Values.nodeConfig.taint | nindent 6 }}
    {{- end }}
    {{- if .Values.nodeConfig.workloadMetadataConfig }}
    workloadMetadataConfig:
      {{- if .Values.nodeConfig.workloadMetadataConfig.mode }}
      mode: {{ .Values.nodeConfig.workloadMetadataConfig.mode }}
      {{- end }}
      {{- if .Values.nodeConfig.workloadMetadataConfig.nodeMetadata }}
      nodeMetadata: {{ .Values.nodeConfig.workloadMetadataConfig.nodeMetadata }}
      {{- end }}
    {{- end }}
  {{- end }}
  {{- if .Values.nodeLocations }}
  nodeLocations: {{ toYaml .Values.nodeLocations | nindent 4 }}
  {{- end }}
  {{- if .Values.nodePoolAutoConfig }}
  nodePoolAutoConfig:
    {{- if .Values.nodePoolAutoConfig.networkTags }}
    networkTags:
      {{- if .Values.nodePoolAutoConfig.networkTags.tags }}
      tags: {{ toYaml .Values.nodePoolAutoConfig.networkTags.tags | nindent 6 }}
      {{- end }}
    {{- end }}
  {{- end }}
  {{- if .Values.nodePoolDefaults }}
  nodePoolDefaults:
    {{- if .Values.nodePoolDefaults.nodeConfigDefaults }}
    nodeConfigDefaults:
      {{- if .Values.nodePoolDefaults.nodeConfigDefaults.gcfsConfig }}
      gcfsConfig:
        enabled: {{ .Values.nodePoolDefaults.nodeConfigDefaults.gcfsConfig.enabled }}
      {{- end }}
      {{- if .Values.nodePoolDefaults.nodeConfigDefaults.loggingVariant }}
      loggingVariant: {{ .Values.nodePoolDefaults.nodeConfigDefaults.loggingVariant }}
      {{- end }}
    {{- end }}
  {{- end }}
  {{- if .Values.nodeVersion }}
  nodeVersion: {{ .Values.nodeVersion }}
  {{- end }}
  {{- if .Values.notificationConfig }}
  notificationConfig:
    {{- if .Values.notificationConfig.pubsub }}
    pubsub:
      enabled: {{ .Values.notificationConfig.pubsub.enabled }}
      {{- if .Values.notificationConfig.pubsub.filter }}
      filter:
        {{- if .Values.notificationConfig.pubsub.filter.eventType }}
        eventType: {{ toYaml .Values.notificationConfig.pubsub.filter.eventType | nindent 8 }}
        {{- end }}
      {{- end }}
      {{- if .Values.notificationConfig.pubsub.topicRef }}
      topicRef:
        {{- if .Values.notificationConfig.pubsub.topicRef.external }}
        external: {{ .Values.notificationConfig.pubsub.topicRef.external }}
        {{- end }}
        {{- if .Values.notificationConfig.pubsub.topicRef.name }}
        name: {{ .Values.notificationConfig.pubsub.topicRef.name }}
        {{- end }}
        {{- if .Values.notificationConfig.pubsub.topicRef.namespace }}
        namespace: {{ .Values.notificationConfig.pubsub.topicRef.namespace }}
        {{- end }}
      {{- end }}
    {{- end }}
  {{- end }}
  {{- if .Values.podSecurityPolicyConfig }}
  podSecurityPolicyConfig:
    enabled: {{ .Values.podSecurityPolicyConfig.enabled }}
  {{- end }}
  {{- if .Values.privateClusterConfig }}
  privateClusterConfig:
    enablePrivateEndpoint: {{ .Values.privateClusterConfig.enablePrivateEndpoint }}
    enablePrivateNodes: {{ .Values.privateClusterConfig.enablePrivateNodes }}
    {{- if .Values.privateClusterConfig.masterGlobalAccessConfig }}
    masterGlobalAccessConfig:
      enabled: {{ .Values.privateClusterConfig.masterGlobalAccessConfig.enabled }}
    {{- end }}
    {{- if .Values.privateClusterConfig.masterIpv4CidrBlock }}
    masterIpv4CidrBlock: {{ .Values.privateClusterConfig.masterIpv4CidrBlock }}
    {{- end }}
    {{- if .Values.privateClusterConfig.peeringName }}
    peeringName: {{ .Values.privateClusterConfig.peeringName }}
    {{- end }}
    {{- if .Values.privateClusterConfig.privateEndpoint }}
    privateEndpoint: {{ .Values.privateClusterConfig.privateEndpoint }}
    {{- end }}
    {{- if .Values.privateClusterConfig.privateEndpointSubnetworkRef }}
    privateEndpointSubnetworkRef:
      {{- if .Values.privateClusterConfig.privateEndpointSubnetworkRef.external }}
      external: {{ .Values.privateClusterConfig.privateEndpointSubnetworkRef.external }}
      {{- end }}
      {{- if .Values.privateClusterConfig.privateEndpointSubnetworkRef.name }}
      name: {{ .Values.privateClusterConfig.privateEndpointSubnetworkRef.name }}
      {{- end }}
      {{- if .Values.privateClusterConfig.privateEndpointSubnetworkRef.namespace }}
      namespace: {{ .Values.privateClusterConfig.privateEndpointSubnetworkRef.namespace }}
      {{- end }}
    {{- end }}
    {{- if .Values.privateClusterConfig.publicEndpoint }}
    publicEndpoint: {{ .Values.privateClusterConfig.publicEndpoint }}
    {{- end }}
  {{- end }}
  {{- if .Values.privateIpv6GoogleAccess }}
  privateIpv6GoogleAccess: {{ .Values.privateIpv6GoogleAccess }}
  {{- end }}
  {{- if .Values.protectConfig }}
  protectConfig:
    {{- if .Values.protectConfig.workloadConfig }}
    workloadConfig:
      {{- if .Values.protectConfig.workloadConfig.auditMode }}
      auditMode: {{ .Values.protectConfig.workloadConfig.auditMode }}
      {{- end }}
    {{- end }}
    {{- if .Values.protectConfig.workloadVulnerabilityMode }}
    workloadVulnerabilityMode: {{ .Values.protectConfig.workloadVulnerabilityMode }}
    {{- end }}
  {{- end }}
  {{- if .Values.releaseChannel }}
  releaseChannel:
    {{- if .Values.releaseChannel.channel }}
    channel: {{ .Values.releaseChannel.channel }}
    {{- end }}
  {{- end }}
  {{- if .Values.resourceID }}
  resourceID: {{ .Values.resourceID }}
  {{- end }}
  {{- if .Values.resourceUsageExportConfig }}
  resourceUsageExportConfig:
    {{- if .Values.resourceUsageExportConfig.bigqueryDestination }}
    bigqueryDestination:
      {{- if .Values.resourceUsageExportConfig.bigqueryDestination.datasetId }}
      datasetId: {{ .Values.resourceUsageExportConfig.bigqueryDestination.datasetId }}
      {{- end }}
    {{- end }}
    enableNetworkEgressMetering: {{ .Values.resourceUsageExportConfig.enableNetworkEgressMetering }}
    enableResourceConsumptionMetering: {{ .Values.resourceUsageExportConfig.enableResourceConsumptionMetering }}
  {{- end }}
  {{- if .Values.securityPostureConfig }}
  securityPostureConfig:
    {{- if .Values.securityPostureConfig.mode }}
    mode: {{ .Values.securityPostureConfig.mode }}
    {{- end }}
    {{- if .Values.securityPostureConfig.vulnerabilityMode }}
    vulnerabilityMode: {{ .Values.securityPostureConfig.vulnerabilityMode }}
    {{- end }}
  {{- end }}
  {{- if .Values.serviceExternalIpsConfig }}
  serviceExternalIpsConfig:
    enabled: {{ .Values.serviceExternalIpsConfig.enabled }}
  {{- end }}
  {{- if .Values.verticalPodAutoscaling }}
  verticalPodAutoscaling:
    enabled: {{ .Values.verticalPodAutoscaling.enabled }}
  {{- end }}
  {{- if .Values.workloadIdentityConfig }}
  workloadIdentityConfig:
    {{- if .Values.workloadIdentityConfig.identityNamespace }}
    identityNamespace: {{ .Values.workloadIdentityConfig.identityNamespace }}
    {{- end }}
    {{- if .Values.workloadIdentityConfig.workloadPool }}
    workloadPool: {{ .Values.workloadIdentityConfig.workloadPool }}
    {{- end }}
  {{- end }}